# Mapeamento e navegação

Esta documentação fornece uma visão geral do projeto Turtlebot3, que utiliza o ROS2 e o Nav2 para controle de um robô Turtlebot3. O projeto é dividido em dois workspaces localizados na pasta src/bridge. O primeiro workspace é dedicado ao mapeamento, enquanto o segundo lida com a navegação.

## Mapeamento (mapping_launch)

O workspace de mapeamento contém um launcher em C++ que inicia os pacotes de teleop (controle manual) e Cartographer (mapeamento). Além disso, um script em bash está presente para salvar automaticamente o mapa gerado como um arquivo YAML e uma imagem quando o comando Ctrl+C é pressionado no terminal.

### Execução

Para executar o mapeamento, utilize os seguintes comandos na pasta raiz do workspace:

```bash

chmod +x mapping_zsh.sh
./mapping_zsh.sh

```

No terminal extra que será aberto, utilize o teclado para movimentar o robô. Na aba de navegação com Rviz, observe a formação do mapa. Quando ele estiver bem definido, pressione Ctrl-C no terminal inicial para salvar o mapa. Ele será salvo na pasta do workspace com o nome "map.yaml" e "map.pgm".


## Navegação (nav_workspace)
O workspace de navegação contém um pacote com um script em bash que inicia o Rviz com um arquivo de mapa fornecido como argumento. Além disso, há cinco nós: um para abrir um terminal de chatbot, um para abrir um terminal de entrada de coordenadas, um nó para inicializar a pose do robô, e um nó para gerenciar a fila de pontos. O quinto nó, chamado Vallet, utiliza a API do Simple Commander para comunicação programática com o Nav2.

# Execução

Para executar a navegação, utilize os seguintes comandos na pasta raiz do workspace:

```bash

colcon build
source install/setup.bash
bash run.sh <nome-do-mapa>.yaml

```

Tanto através do chatbot quanto do terminal de coordenadas, é possível enviar pontos para o robô. Esses pontos são publicados no tópico chatbot_msgs como mensagens do tipo Pose. O nó de fila se inscreve nesse tópico, enfileira os pontos e aguarda o status do nó Vallet.

Quando o nó Vallet está disponível, a fila publica o próximo ponto no tópico poses. O nó Vallet escuta esse tópico, envia uma ação de goToPose quando disponível e aguarda uma nova pose. Após a conclusão, o nó Vallet publica "Busy" no tópico status, indicando que está ocupado, e posteriormente, "Free" ao finalizar.